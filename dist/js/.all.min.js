var TodoApp;!function(o){var t=function(){function o(o){this._todoData=o}return o.prototype.getHTML=function(){return'\n            <li class="listUOC-item">\n                <div href="#" class="listUOC-item-todo">'+this._todoData.todoTxt+'</div>\n                <button data-id="'+this._todoData.id+'"  class="btn btUOC listUOC-item-removeBt btUOC-grey"><span class="glyphicon glyphicon-trash"></span> Remove</button>\n            </li>\n            '},o}();o.TodoItem=t}(TodoApp||(TodoApp={}));var TodoApp;!function(o){var t=function(){function t(){var o=this;this._todoList=[],this._idCounter=0,this.saveNewTodo=function(){console.log("//SAVE NEW TODO");var t=o.$newTodoInput.val();if(""!=t){var s={id:o._idCounter,todoTxt:t};o.addTodo(s,!0),o.$newTodoInput.val("")}},this.onLoadTodosDataSuccess=function(t){var s,i,e;for(i=t.length,s=0;s<i;s++)e=t[s],o.addTodo(e,!1);o.render()},this.onLoadTodosDataError=function(){console.log("Error loading data.")},this.deleteTodo=function(t){console.log("//DELETE ITEM");var s=$(t.currentTarget);console.log("CLICK:"+parseInt(s.data("id"))),o.deleteTodoById(parseInt(s.data("id")))},this.$todoList=$(t.DOM_TODOLIST),this.$saveTodoBt=$(t.DOM_SAVETODO_BT),this.$newTodoInput=$(t.DOM_NEWTODO_INPUT),this.$todoList.on("click",".listUOC-item-removeBt",this.deleteTodo),this.$saveTodoBt.on("click",this.saveNewTodo),$("form").submit(function(){return!1}),this.checkTodoListData()}return t.prototype.render=function(){console.log("//RENDER");var s=$(t.DOM_TODOLIST_CONTAINER);this.$todoList.detach(),this.$todoList.empty();for(var i=0;i<this._todoList.length;i++){var e=new o.TodoItem(this._todoList[i]);this.$todoList.append(e.getHTML())}s.append(this.$todoList)},t.prototype.checkTodoListData=function(){var o,s;o=store.get(t.PERSISTENT_OBJECT_KEY),s=$(t.DOM_ALERT_FIRST_TIME),o?(s.remove(),this.onLoadTodosDataSuccess(o)):(console.log("//NO DATA"),this.loadFirstTimeData())},t.prototype.loadFirstTimeData=function(){$.ajax({dataType:"json",url:t.PERSISTENT_OBJECT_DATA_PATH,success:this.onLoadTodosDataSuccess,error:this.onLoadTodosDataError})},t.prototype.savePersistentData=function(){var o,s,i,e,T;for(T=[],s=this._todoList.length,o=0;o<s;o++)i=this._todoList[o],e={},e[t.PERSISTENT_OBJECT_TODO_ID]=i.id,e[t.PERSISTENT_OBJECT_TODO_TXT]=i.todoTxt,T.push(e);store.clear(),store.set(t.PERSISTENT_OBJECT_KEY,T)},t.prototype.addTodo=function(o,t){this._todoList.push(o),this._idCounter++,this.savePersistentData(),t&&this.render()},t.prototype.deleteTodoById=function(o){console.log("TODO DELETED");var t=0,s=this._todoList.length;for(t=0;t<s;t++)if(this._todoList[t].id==o){this._todoList.splice(t,1);break}this.savePersistentData(),this.render()},t}();t.DOM_TODOLIST_CONTAINER="#todo-list-container",t.DOM_TODOLIST="#todo-list",t.DOM_NEWTODO_INPUT="#new-todo-input",t.DOM_SAVETODO_BT="#save-todo-bt",t.DOM_ALERT_FIRST_TIME="#alert-first-time",t.PERSISTENT_OBJECT_KEY="todoList",t.PERSISTENT_OBJECT_DATA_PATH="data/defaultdata.json",t.PERSISTENT_OBJECT_TODO_ID="id",t.PERSISTENT_OBJECT_TODO_TXT="todoTxt",o.TodoList=t}(TodoApp||(TodoApp={}));var app;window.onload=function(){console.log("/// APP INIT"),app=new TodoApp.TodoList};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAuanMiXSwibmFtZXMiOlsiVG9kb0FwcCIsIlRvZG9JdGVtIiwidG9kb0RhdGEiLCJ0aGlzIiwiX3RvZG9EYXRhIiwicHJvdG90eXBlIiwiZ2V0SFRNTCIsInRvZG9UeHQiLCJpZCIsIlRvZG9MaXN0IiwiX3RoaXMiLCJfdG9kb0xpc3QiLCJfaWRDb3VudGVyIiwic2F2ZU5ld1RvZG8iLCJjb25zb2xlIiwibG9nIiwiJG5ld1RvZG9JbnB1dCIsInZhbCIsIm5ld1RvZG8iLCJhZGRUb2RvIiwib25Mb2FkVG9kb3NEYXRhU3VjY2VzcyIsImRhdGEiLCJpIiwiblRvZG9zIiwiY3VycmVudFRvZG9EYXRhIiwibGVuZ3RoIiwicmVuZGVyIiwib25Mb2FkVG9kb3NEYXRhRXJyb3IiLCJkZWxldGVUb2RvIiwiZSIsIiR0YXJnZXQiLCIkIiwiY3VycmVudFRhcmdldCIsInBhcnNlSW50IiwiZGVsZXRlVG9kb0J5SWQiLCIkdG9kb0xpc3QiLCJET01fVE9ET0xJU1QiLCIkc2F2ZVRvZG9CdCIsIkRPTV9TQVZFVE9ET19CVCIsIkRPTV9ORVdUT0RPX0lOUFVUIiwib24iLCJzdWJtaXQiLCJjaGVja1RvZG9MaXN0RGF0YSIsIiR0b2RvTGlzdENvbnRhaW5lciIsIkRPTV9UT0RPTElTVF9DT05UQUlORVIiLCJkZXRhY2giLCJlbXB0eSIsIml0ZW0iLCJhcHBlbmQiLCJzdG9yZWREYXRhIiwiJGFsZXJ0Rmlyc3RUaW1lIiwic3RvcmUiLCJnZXQiLCJQRVJTSVNURU5UX09CSkVDVF9LRVkiLCJET01fQUxFUlRfRklSU1RfVElNRSIsInJlbW92ZSIsImxvYWRGaXJzdFRpbWVEYXRhIiwiYWpheCIsImRhdGFUeXBlIiwidXJsIiwiUEVSU0lTVEVOVF9PQkpFQ1RfREFUQV9QQVRIIiwic3VjY2VzcyIsImVycm9yIiwic2F2ZVBlcnNpc3RlbnREYXRhIiwiY3VycmVudFRvZG8iLCJzYXZlZFRvZG8iLCJ0b2RvTGlzdEpTT04iLCJQRVJTSVNURU5UX09CSkVDVF9UT0RPX0lEIiwiUEVSU0lTVEVOVF9PQkpFQ1RfVE9ET19UWFQiLCJwdXNoIiwiY2xlYXIiLCJzZXQiLCJuZXdUb2RvRGF0YSIsImZvcmNlUmVuZGVyIiwic3BsaWNlIiwiYXBwIiwid2luZG93Iiwib25sb2FkIl0sIm1hcHBpbmdzIjoiQUFHQSxHQUFBQSxVQUNBLFNBQUFBLEdBQ0EsR0FBQUMsR0FBQSxXQUNBLFFBQUFBLEdBQUFDLEdBRUFDLEtBQUFDLFVBQUFGLEVBUUEsTUFOQUQsR0FBQUksVUFBQUMsUUFBQSxXQUlBLE1BREEsb0dBQUFILEtBQUFDLFVBQUFHLFFBQUEsNENBQUFKLEtBQUFDLFVBQUFJLEdBQUEsMEpBR0FQLElBRUFELEdBQUFDLFNBQUFBLEdBQ0FELFVBQUFBLFlBSUEsSUFBQUEsVUFDQSxTQUFBQSxHQUNBLEdBQUFTLEdBQUEsV0FDQSxRQUFBQSxLQUNBLEdBQUFDLEdBQUFQLElBRUFBLE1BQUFRLGFBQ0FSLEtBQUFTLFdBQUEsRUFFQVQsS0FBQVUsWUFBQSxXQUNBQyxRQUFBQyxJQUFBLGtCQUVBLElBQUFSLEdBQUFHLEVBQUFNLGNBQUFDLEtBRUEsSUFBQSxJQUFBVixFQUFBLENBRUEsR0FBQVcsSUFDQVYsR0FBQUUsRUFBQUUsV0FDQUwsUUFBQUEsRUFFQUcsR0FBQVMsUUFBQUQsR0FBQSxHQUVBUixFQUFBTSxjQUFBQyxJQUFBLE1BR0FkLEtBQUFpQix1QkFBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQ0FDLEVBQ0FDLENBRUEsS0FEQUQsRUFBQUYsRUFBQUksT0FDQUgsRUFBQSxFQUFBQSxFQUFBQyxFQUFBRCxJQUNBRSxFQUFBSCxFQUFBQyxHQUNBWixFQUFBUyxRQUFBSyxHQUFBLEVBRUFkLEdBQUFnQixVQUVBdkIsS0FBQXdCLHFCQUFBLFdBQ0FiLFFBQUFDLElBQUEsd0JBRUFaLEtBQUF5QixXQUFBLFNBQUFDLEdBQ0FmLFFBQUFDLElBQUEsZ0JBQ0EsSUFBQWUsR0FBQUMsRUFBQUYsRUFBQUcsY0FDQWxCLFNBQUFDLElBQUEsU0FBQWtCLFNBQUFILEVBQUFULEtBQUEsUUFD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InNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ3JlYXRlZCBieSBmbWl4YWdlbnQgb24gMDEvMDMvMjAxNy5cbiAqL1xudmFyIFRvZG9BcHA7XG4oZnVuY3Rpb24gKFRvZG9BcHApIHtcbiAgICB2YXIgVG9kb0l0ZW0gPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBUb2RvSXRlbSh0b2RvRGF0YSkge1xuICAgICAgICAgICAgLy8gUmVjb3ZlciBkYXRhXG4gICAgICAgICAgICB0aGlzLl90b2RvRGF0YSA9IHRvZG9EYXRhO1xuICAgICAgICB9XG4gICAgICAgIFRvZG9JdGVtLnByb3RvdHlwZS5nZXRIVE1MID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gQ3JlYXRlIHRlbXBsYXRlIHdpdGggdG9kbyB0ZXh0XG4gICAgICAgICAgICB2YXIgaXRlbUhUTUw7XG4gICAgICAgICAgICBpdGVtSFRNTCA9IFwiXFxuICAgICAgICAgICAgPGxpIGNsYXNzPVxcXCJsaXN0VU9DLWl0ZW1cXFwiPlxcbiAgICAgICAgICAgICAgICA8ZGl2IGhyZWY9XFxcIiNcXFwiIGNsYXNzPVxcXCJsaXN0VU9DLWl0ZW0tdG9kb1xcXCI+XCIgKyB0aGlzLl90b2RvRGF0YS50b2RvVHh0ICsgXCI8L2Rpdj5cXG4gICAgICAgICAgICAgICAgPGJ1dHRvbiBkYXRhLWlkPVxcXCJcIiArIHRoaXMuX3RvZG9EYXRhLmlkICsgXCJcXFwiICBjbGFzcz1cXFwiYnRuIGJ0VU9DIGxpc3RVT0MtaXRlbS1yZW1vdmVCdCBidFVPQy1ncmV5XFxcIj48c3BhbiBjbGFzcz1cXFwiZ2x5cGhpY29uIGdseXBoaWNvbi10cmFzaFxcXCI+PC9zcGFuPiBSZW1vdmU8L2J1dHRvbj5cXG4gICAgICAgICAgICA8L2xpPlxcbiAgICAgICAgICAgIFwiO1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW1IVE1MO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVG9kb0l0ZW07XG4gICAgfSgpKTtcbiAgICBUb2RvQXBwLlRvZG9JdGVtID0gVG9kb0l0ZW07XG59KShUb2RvQXBwIHx8IChUb2RvQXBwID0ge30pKTtcbi8qKlxuICogQ3JlYXRlZCBieSBmbWl4YWdlbnQgb24gMDEvMDMvMjAxNy5cbiAqL1xudmFyIFRvZG9BcHA7XG4oZnVuY3Rpb24gKFRvZG9BcHApIHtcbiAgICB2YXIgVG9kb0xpc3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBUb2RvTGlzdCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAvLyBBUFAgUFJJVkFURSBWQVJTXG4gICAgICAgICAgICB0aGlzLl90b2RvTGlzdCA9IFtdOyAvLyBMaXN0IG9mIHRvZG9zXG4gICAgICAgICAgICB0aGlzLl9pZENvdW50ZXIgPSAwOyAvLyBGb3IgdGhlIG5leHQgdG9kbyB0byBzYXZlXG4gICAgICAgICAgICAvLyBBZGQgbmV3IHRvZG9cbiAgICAgICAgICAgIHRoaXMuc2F2ZU5ld1RvZG8gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCIvL1NBVkUgTkVXIFRPRE9cIik7XG4gICAgICAgICAgICAgICAgLy8gUmVjb3ZlciB0b2RvIGRhdGFcbiAgICAgICAgICAgICAgICB2YXIgdG9kb1R4dCA9IF90aGlzLiRuZXdUb2RvSW5wdXQudmFsKCk7XG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGxpc3QgaWYgbmV3IHRvZG8gaW50cm9kdWNlZFxuICAgICAgICAgICAgICAgIGlmICh0b2RvVHh0ICE9IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRvZG8gbGlzdFxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VG9kbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBfdGhpcy5faWRDb3VudGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG9kb1R4dDogdG9kb1R4dFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hZGRUb2RvKG5ld1RvZG8sIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAvLyBFbXB0eSBpbnB1dCBmaWVsZFxuICAgICAgICAgICAgICAgICAgICBfdGhpcy4kbmV3VG9kb0lucHV0LnZhbChcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5vbkxvYWRUb2Rvc0RhdGFTdWNjZXNzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgICAgICB2YXIgblRvZG9zO1xuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VG9kb0RhdGE7XG4gICAgICAgICAgICAgICAgblRvZG9zID0gZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5Ub2RvczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUb2RvRGF0YSA9IGRhdGFbaV07XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkZFRvZG8oY3VycmVudFRvZG9EYXRhLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF90aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMub25Mb2FkVG9kb3NEYXRhRXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGxvYWRpbmcgZGF0YS4nKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVRvZG8gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLy9ERUxFVEUgSVRFTVwiKTtcbiAgICAgICAgICAgICAgICB2YXIgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNMSUNLOlwiICsgcGFyc2VJbnQoJHRhcmdldC5kYXRhKCdpZCcpKSk7XG4gICAgICAgICAgICAgICAgX3RoaXMuZGVsZXRlVG9kb0J5SWQocGFyc2VJbnQoJHRhcmdldC5kYXRhKCdpZCcpKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgLy8gRE9NIEVMRU1FTlRTXG4gICAgICAgICAgICB0aGlzLiR0b2RvTGlzdCA9ICQoVG9kb0xpc3QuRE9NX1RPRE9MSVNUKTtcbiAgICAgICAgICAgIHRoaXMuJHNhdmVUb2RvQnQgPSAkKFRvZG9MaXN0LkRPTV9TQVZFVE9ET19CVCk7XG4gICAgICAgICAgICB0aGlzLiRuZXdUb2RvSW5wdXQgPSAkKFRvZG9MaXN0LkRPTV9ORVdUT0RPX0lOUFVUKTtcbiAgICAgICAgICAgIC8vIENMSUNLIEVWRU5UU1xuICAgICAgICAgICAgdGhpcy4kdG9kb0xpc3Qub24oJ2NsaWNrJywgJy5saXN0VU9DLWl0ZW0tcmVtb3ZlQnQnLCB0aGlzLmRlbGV0ZVRvZG8pO1xuICAgICAgICAgICAgdGhpcy4kc2F2ZVRvZG9CdC5vbignY2xpY2snLCB0aGlzLnNhdmVOZXdUb2RvKTtcbiAgICAgICAgICAgIC8vIERpc2FibGUgZm9ybSBzdWJtaXRcbiAgICAgICAgICAgICQoJ2Zvcm0nKS5zdWJtaXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gREVGQVVMVFNcbiAgICAgICAgICAgIHRoaXMuY2hlY2tUb2RvTGlzdERhdGEoKTtcbiAgICAgICAgfVxuICAgICAgICBUb2RvTGlzdC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCIvL1JFTkRFUlwiKTtcbiAgICAgICAgICAgIC8vIFJlZmVyZW5jZSB0byB0aGUgRE9NIGVsZW1lbnQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIHRvZG8gbGlzdFxuICAgICAgICAgICAgdmFyICR0b2RvTGlzdENvbnRhaW5lciA9ICQoVG9kb0xpc3QuRE9NX1RPRE9MSVNUX0NPTlRBSU5FUik7XG4gICAgICAgICAgICAvLyBFbXB0eSBvbGQgdG9kbyBsaXN0XG4gICAgICAgICAgICB0aGlzLiR0b2RvTGlzdC5kZXRhY2goKTtcbiAgICAgICAgICAgIHRoaXMuJHRvZG9MaXN0LmVtcHR5KCk7XG4gICAgICAgICAgICAvLyBDcmVhdGUgbmV3IHRvZG8gbGlzdFxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl90b2RvTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gbmV3IFRvZG9BcHAuVG9kb0l0ZW0odGhpcy5fdG9kb0xpc3RbaV0pO1xuICAgICAgICAgICAgICAgIHRoaXMuJHRvZG9MaXN0LmFwcGVuZChpdGVtLmdldEhUTUwoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBZGQgdG8gRE9NXG4gICAgICAgICAgICAkdG9kb0xpc3RDb250YWluZXIuYXBwZW5kKHRoaXMuJHRvZG9MaXN0KTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gU1RPUkUgREFUQVxuICAgICAgICBUb2RvTGlzdC5wcm90b3R5cGUuY2hlY2tUb2RvTGlzdERhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc3RvcmVkRGF0YTtcbiAgICAgICAgICAgIHZhciAkYWxlcnRGaXJzdFRpbWU7XG4gICAgICAgICAgICBzdG9yZWREYXRhID0gc3RvcmUuZ2V0KFRvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX0tFWSk7XG4gICAgICAgICAgICAkYWxlcnRGaXJzdFRpbWUgPSAkKFRvZG9MaXN0LkRPTV9BTEVSVF9GSVJTVF9USU1FKTtcbiAgICAgICAgICAgIGlmIChzdG9yZWREYXRhKSB7XG4gICAgICAgICAgICAgICAgJGFsZXJ0Rmlyc3RUaW1lLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMub25Mb2FkVG9kb3NEYXRhU3VjY2VzcyhzdG9yZWREYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLy9OTyBEQVRBXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMubG9hZEZpcnN0VGltZURhdGEoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgO1xuICAgICAgICBUb2RvTGlzdC5wcm90b3R5cGUubG9hZEZpcnN0VGltZURhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgICAgICAgICB1cmw6IFRvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX0RBVEFfUEFUSCxcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiB0aGlzLm9uTG9hZFRvZG9zRGF0YVN1Y2Nlc3MsXG4gICAgICAgICAgICAgICAgZXJyb3I6IHRoaXMub25Mb2FkVG9kb3NEYXRhRXJyb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBUb2RvTGlzdC5wcm90b3R5cGUuc2F2ZVBlcnNpc3RlbnREYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICB2YXIgblRvZG9zO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUb2RvO1xuICAgICAgICAgICAgdmFyIHNhdmVkVG9kbztcbiAgICAgICAgICAgIHZhciB0b2RvTGlzdEpTT047XG4gICAgICAgICAgICB0b2RvTGlzdEpTT04gPSBbXTtcbiAgICAgICAgICAgIG5Ub2RvcyA9IHRoaXMuX3RvZG9MaXN0Lmxlbmd0aDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuVG9kb3M7IGkrKykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRUb2RvID0gdGhpcy5fdG9kb0xpc3RbaV07XG4gICAgICAgICAgICAgICAgc2F2ZWRUb2RvID0ge307XG4gICAgICAgICAgICAgICAgc2F2ZWRUb2RvW1RvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fSURdID0gY3VycmVudFRvZG8uaWQ7XG4gICAgICAgICAgICAgICAgc2F2ZWRUb2RvW1RvZG9MaXN0LlBFUlNJU1RFTlRfT0JKRUNUX1RPRE9fVFhUXSA9IGN1cnJlbnRUb2RvLnRvZG9UeHQ7XG4gICAgICAgICAgICAgICAgdG9kb0xpc3RKU09OLnB1c2goc2F2ZWRUb2RvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN0b3JlLmNsZWFyKCk7XG4gICAgICAgICAgICBzdG9yZS5zZXQoVG9kb0xpc3QuUEVSU0lTVEVOVF9PQkpFQ1RfS0VZLCB0b2RvTGlzdEpTT04pO1xuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIFRvZG9MaXN0LnByb3RvdHlwZS5hZGRUb2RvID0gZnVuY3Rpb24gKG5ld1RvZG9EYXRhLCBmb3JjZVJlbmRlcikge1xuICAgICAgICAgICAgdGhpcy5fdG9kb0xpc3QucHVzaChuZXdUb2RvRGF0YSk7XG4gICAgICAgICAgICB0aGlzLl9pZENvdW50ZXIrKztcbiAgICAgICAgICAgIHRoaXMuc2F2ZVBlcnNpc3RlbnREYXRhKCk7XG4gICAgICAgICAgICBpZiAoZm9yY2VSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICA7XG4gICAgICAgIFRvZG9MaXN0LnByb3RvdHlwZS5kZWxldGVUb2RvQnlJZCA9IGZ1bmN0aW9uIChpZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUT0RPIERFTEVURURcIik7XG4gICAgICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgICAgICB2YXIgblRvZG9zID0gdGhpcy5fdG9kb0xpc3QubGVuZ3RoO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5Ub2RvczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RvZG9MaXN0W2ldLmlkID09IGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RvZG9MaXN0LnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zYXZlUGVyc2lzdGVudERhdGEoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBUb2RvTGlzdDtcbiAgICB9KCkpO1xuICAgIC8vIFRFTVBMQVRFIHwgRE9NIEVMRU1FTlRTXG4gICAgVG9kb0xpc3QuRE9NX1RPRE9MSVNUX0NPTlRBSU5FUiA9ICcjdG9kby1saXN0LWNvbnRhaW5lcic7XG4gICAgVG9kb0xpc3QuRE9NX1RPRE9MSVNUID0gJyN0b2RvLWxpc3QnO1xuICAgIFRvZG9MaXN0LkRPTV9ORVdUT0RPX0lOUFVUID0gJyNuZXctdG9kby1pbnB1dCc7XG4gICAgVG9kb0xpc3QuRE9NX1NBVkVUT0RPX0JUID0gJyNzYXZlLXRvZG8tYnQnO1xuICAgIC8vIFNUT1JFIFJFTEFURURcbiAgICBUb2RvTGlzdC5ET01fQUxFUlRfRklSU1RfVElNRSA9ICcjYWxlcnQtZmlyc3QtdGltZSc7XG4gICAgVG9kb0xpc3QuUEVSU0lTVEVOVF9PQkpFQ1RfS0VZID0gJ3RvZG9MaXN0JztcbiAgICBUb2RvTGlzdC5QRVJTSVNURU5UX09CSkVDVF9EQVRBX1BBVEggPSAnZGF0YS9kZWZhdWx0ZGF0YS5qc29uJztcbiAgICBUb2RvTGlzdC5QRVJTSVNURU5UX09CSkVDVF9UT0RPX0lEID0gJ2lkJztcbiAgICBUb2RvTGlzdC5QRVJTSVNURU5UX09CSkVDVF9UT0RPX1RYVCA9ICd0b2RvVHh0JztcbiAgICBUb2RvQXBwLlRvZG9MaXN0ID0gVG9kb0xpc3Q7XG59KShUb2RvQXBwIHx8IChUb2RvQXBwID0ge30pKTtcbnZhciBhcHA7XG53aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUubG9nKFwiLy8vIEFQUCBJTklUXCIpO1xuICAgIC8vIFRlc3QgdG9kb0l0ZW1cbiAgICBhcHAgPSBuZXcgVG9kb0FwcC5Ub2RvTGlzdCgpO1xufTtcbiJdfQ==
